buildscript {
  repositories {
    maven {
      url "https://plugins.gradle.org/m2/"
    }
  }
  dependencies {
    classpath "gradle.plugin.com.github.spotbugs.snom:spotbugs-gradle-plugin:4.7.5"
  }
}

subprojects {
  spotbugs {
    effort = 'max'
    excludeFilter = rootProject.file('config/spotbugs/excludeFilter.xml')
  }

  spotbugsMain {
    reports {
      xml { required = true }
      html {
        required = true
        outputLocation = file("$buildDir/reports/spotbugs/main.html")
        stylesheet = 'fancy-hist.xsl'
      }
    }
  }

  spotbugsTest {
    reports {
      xml { required = true }
      html {
        required = true
        outputLocation = file("$buildDir/reports/spotbugs/test.html")
        stylesheet = 'fancy-hist.xsl'
      }
    }
  }

  tasks.withType(Checkstyle) {
    maxWarnings = 0
    showViolations = true
    reports {
      xml.enabled(System.getenv('CI') != null)
      html.enabled(System.getenv('CI') == null)
    }
  }

  sonarqube {
    properties {
      property 'sonar.projectName', 'selenide'
      property 'sonar.jacoco.reportPaths', "$project.buildDir/jacoco/test.exec, $project.buildDir/jacoco/chrome_headless.exec, $project.buildDir/jacoco/firefox_headless.exec"
    }
  }
}
